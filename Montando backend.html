<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Task Manager - Guia de Configuração</title>
  <style>
    :root{
      --bg: #0b0f14;
      --surface: #0f1720;
      --muted: #98a0aa;
      --text: #e6eef6;
      --accent: #6ee7b7;
      --code-bg: #081018;
      --card-shadow: rgba(0,0,0,0.6);
      --glass: rgba(255,255,255,0.02);
      --border: rgba(255,255,255,0.04);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{
      margin:0;
      background: linear-gradient(180deg, var(--bg), var(--surface));
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* inline padding requested: left/right 20vw */
    body{
      padding-inline: 8vw;
      padding-top:3rem;
      padding-bottom:3rem;
      box-sizing:border-box;
      line-height:1.6;
    }

    .container{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:2rem;
      box-shadow: 0 8px 30px var(--card-shadow);
      border:1px solid var(--border);
    }

    h1{
      margin:0 0 0.5rem 0;
      font-size:1.8rem;
      color:var(--accent);
    }

    h2{
      margin:1.25rem 0 0.5rem 0;
      font-size:1.15rem;
      color:var(--text);
      border-bottom:1px dashed rgba(255,255,255,0.03);
      padding-bottom:0.4rem;
    }

    p, li{
      color:var(--muted);
      font-size:0.98rem;
    }

    pre {
      background: linear-gradient(180deg, var(--code-bg), rgba(10,18,28,0.9));
      color: #cfeff0;
      padding:0.8rem;
      border-radius:8px;
      overflow:auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
      font-size:0.92rem;
      border:1px solid rgba(255,255,255,0.02);
      margin:0.6rem 0;
    }

    code { font-family: inherit; }

    .step {
      margin-top:1rem;
      padding:1rem;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.02);
    }

    .kbd {
      display:inline-block;
      border-radius:6px;
      padding:0.1rem 0.45rem;
      background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
      color:var(--text);
      font-size:0.9rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    }

    .small {
      font-size:0.9rem;
      color:var(--muted);
    }

    ul { padding-left:1.1rem; }
    li + li { margin-top:0.45rem; }

    footer {
      margin-top:1.6rem;
      font-size:0.85rem;
      color:var(--muted);
      border-top:1px solid rgba(255,255,255,0.02);
      padding-top:0.8rem;
    }

    @media(max-width:980px){
      body{ padding-left:3rem; padding-right:3rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Task Manager — Guia passo a passo</h1>
    <p class="small">Projeto simples: Front-end (Vue 3) + Back-end (PHP) + MySQL (Docker). Este documento reúne as etapas para criar o backend, banco e estrutura de pastas.</p>

    <section class="step">
      <h2>Etapa 1 — Banco de Dados (MySQL via Docker + Beekeeper)</h2>
      <p>Criar e rodar um container MySQL localmente (porta alternativa 3311) para conectar via Beekeeper Studio.</p>

      <p><strong>Comando Docker:</strong></p>
      <pre><code>docker run --name taskmanager-mysql -e MYSQL_ROOT_PASSWORD=1234 -p 3311:3306 -d mysql:8</code></pre>

      <p class="small">Depois, no Beekeeper Studio conecte com:</p>
      <ul>
        <li><span class="kbd">Host:</span> 127.0.0.1</li>
        <li><span class="kbd">Porta:</span> 3311</li>
        <li><span class="kbd">Usuário:</span> root</li>
        <li><span class="kbd">Senha:</span> 1234</li>
      </ul>

      <p>Execute estas queries para criar o banco e a tabela:</p>
      <pre><code>CREATE DATABASE task_manager;

USE task_manager;

CREATE TABLE tasks (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    completed BOOLEAN DEFAULT 0
);</code></pre>

      <p class="small">Verifique em Beekeeper se a tabela <code>tasks</code> existe e se a conexão está OK.</p>
    </section>

    <section class="step">
      <h2>Etapa 2 — Estrutura de pastas</h2>
      <p>Criar a estrutura local do projeto (fora do container):</p>
      <pre><code>projeto/
│
├── backend/
│   ├── index.php
│   ├── config/
│   │   └── database.php
│   ├── controllers/
│   │   └── TaskController.php
│   ├── models/
│   │   └── Task.php
│   ├── routes/
│   │   └── tasks.php
│   └── .htaccess
│
└── frontend/
    └── (criar depois)</code></pre>

      <p class="small">Vamos implementar o backend primeiro para expor a API consumida pelo Vue.</p>
    </section>

    <section class="step">
      <h2>Etapa 3 — Backend (PHP)</h2>

      <h3>Arquivo: <code>backend/config/database.php</code></h3>
      <pre><code>&lt;?php
class Database {
    private $host = "127.0.0.1";
    private $port = "3311";
    private $db_name = "task_manager";
    private $username = "root";
    private $password = "1234";
    public $conn;

    public function getConnection() {
        $this->conn = null;
        try {
            $this->conn = new PDO(
                "mysql:host={$this->host};port={$this->port};dbname={$this->db_name}",
                $this->username,
                $this->password
            );
            $this->conn->exec("set names utf8");
        } catch(PDOException $exception) {
            echo "Erro de conexão: " . $exception->getMessage();
        }
        return $this->conn;
    }
}
</code></pre>

      <h3>Arquivo: <code>backend/models/Task.php</code></h3>
      <pre><code>&lt;?php
class Task {
    private $conn;
    private $table = "tasks";

    public $id;
    public $title;
    public $completed;

    public function __construct($db) {
        $this->conn = $db;
    }

    public function getAll() {
        $query = "SELECT * FROM " . $this->table . " ORDER BY id DESC";
        $stmt = $this->conn->prepare($query);
        $stmt->execute();
        return $stmt;
    }

    public function create() {
        $query = "INSERT INTO " . $this->table . " (title, completed) VALUES (:title, :completed)";
        $stmt = $this->conn->prepare($query);
        $stmt->bindParam(":title", $this->title);
        $stmt->bindParam(":completed", $this->completed);
        return $stmt->execute();
    }

    public function delete() {
        $query = "DELETE FROM " . $this->table . " WHERE id = :id";
        $stmt = $this->conn->prepare($query);
        $stmt->bindParam(":id", $this->id);
        return $stmt->execute();
    }
}
</code></pre>

      <h3>Arquivo: <code>backend/controllers/TaskController.php</code></h3>
      <pre><code>&lt;?php
require_once __DIR__ . '/../models/Task.php';

class TaskController {
    private $db;

    public function __construct($db) {
        $this->db = $db;
    }

    public function list() {
        $task = new Task($this->db);
        $stmt = $task->getAll();
        $tasks = $stmt->fetchAll(PDO::FETCH_ASSOC);
        echo json_encode(["success" => true, "data" => $tasks]);
    }

    public function create($data) {
        $task = new Task($this->db);
        $task->title = $data['title'] ?? '';
        $task->completed = $data['completed'] ?? 0;
        $success = $task->create();
        echo json_encode(["success" => $success]);
    }

    public function delete($id) {
        $task = new Task($this->db);
        $task->id = $id;
        $success = $task->delete();
        echo json_encode(["success" => $success]);
    }
}
</code></pre>

      <h3>Arquivo: <code>backend/routes/tasks.php</code></h3>
      <pre><code>&lt;?php
require_once __DIR__ . '/../config/database.php';
require_once __DIR__ . '/../controllers/TaskController.php';

$database = new Database();
$db = $database->getConnection();

$controller = new TaskController($db);

$method = $_SERVER['REQUEST_METHOD'];

switch ($method) {
    case 'GET':
        $controller->list();
        break;

    case 'POST':
        $data = json_decode(file_get_contents("php://input"), true);
        $controller->create($data);
        break;

    case 'DELETE':
        parse_str($_SERVER['QUERY_STRING'], $query);
        $controller->delete($query['id'] ?? null);
        break;

    default:
        echo json_encode(["success" => false, "message" => "Método não permitido"]);
}
</code></pre>

      <h3>Arquivo: <code>backend/index.php</code></h3>
      <pre><code>&lt;?php
header("Access-Control-Allow-Origin: *");
header("Content-Type: application/json");
header("Access-Control-Allow-Methods: GET, POST, DELETE, OPTIONS");
header("Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With");

$request_uri = $_SERVER['REQUEST_URI'];

if (strpos($request_uri, '/tasks') !== false) {
    require_once __DIR__ . '/routes/tasks.php';
} else {
    echo json_encode(["success" => false, "message" => "Endpoint não encontrado"]);
}
</code></pre>

      <p class="small">Observação: para desenvolvimento rápido você pode rodar o servidor embutido do PHP a partir da pasta <code>backend/</code>:</p>
      <pre><code>php -S localhost:8000</code></pre>

      <p class="small">Teste: abra <code>http://localhost:8000/index.php/tasks</code> — deve retornar um JSON com <code>{ "success": true, "data": [...] }</code>.</p>
    </section>

    <section class="step">
      <h2>Etapa 4 — Fluxo resumido</h2>
      <ul>
        <li>Usuário abre a página (Vue).</li>
        <li>Vue faz <code>GET /index.php/tasks</code> para o backend.</li>
        <li>PHP consulta MySQL (via <code>Database</code> &amp; <code>Task</code> model).</li>
        <li>Vue exibe as tarefas; usuário cria/apaga → Vue manda <code>POST</code> ou <code>DELETE</code>.</li>
        <li>PHP atualiza o banco e responde com JSON.</li>
      </ul>
    </section>

    <footer>
      <div><strong>Próximo passo:</strong> quer que eu gere os arquivos do frontend (Vue 3) prontos para consumir esta API agora? Posso criar um exemplo simples de <code>taskApi.js</code> e os componentes <code>TaskList.vue</code>, <code>TaskForm.vue</code> e <code>TaskItem.vue</code>.</div>
    </footer>
  </div>
</body>
</html>
